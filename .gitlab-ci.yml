image: mingc/android-build-box:latest

variables:
  ANDROID_COMPILE_SDK: "33"
  ANDROID_BUILD_TOOLS: "34.0.4"
  ANDROID_SDK_TOOLS:   "9477386"

stages:
  - build
  - test

before_script:
  - gem install bundler -v 1.17.2
  - bundle update

buildExampleApp:
  stage: build
  script: 
    - bundle --version
    - bundle exec fastlane buildDebug
  artifacts:
    paths:
      - sample/build/outputs/apk/debug/*

test:
  stage: test
  script:
    - bundle exec fastlane test
  artifacts:
    paths:
      - mobile-sdk/build/test-results/*
